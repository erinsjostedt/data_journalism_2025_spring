---
title: "Reverse Engineering Project"
author: "Yugo Hines"
date: "March 12 2025"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999)
```

## Introduction 

In this notebook, we are reverse engineering the story, [STORY NAME](STORY URL)

## Load libraries

Loading required libraries for this analysis.

```{r}

library(tidyverse)
library(lubridate)
library(refinr)
library(janitor)
library(dplyr)

```


## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

```{r}
# Load required data
donors <- read_csv("data/donors0103-0701.csv")

glimpse(donors)

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 


```
##data cleaning vvvvv

```{r}
donors <- donors |>
  mutate(
    amount = str_remove_all(amount, "\\$"),
    amount = str_remove_all(amount, ",")
  )

glimpse(donors)

```


```{r}

donors <- donors |>
  mutate(amount = as.numeric(amount)) |>
  mutate(date = mdy(date)) |>
  mutate(committee_zip = str_sub(committee_zip, start=1L, end=5L)) 
  
glimpse(donors)

```


## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: Add in the week before session began, and the two businessmen gave more than $87,000 to Republican legislators and the North Carolina Republican Party, a key cog in the campaign machine this year as the two major parties fight for control of the General Assembly in November's elections.

* **Analysis summary**:  Before we could confirm the findings, we had to mutate several columns; zip codes needed to be five digits, `date` needed to have the <date> datatype, `amount` needed to be the <dbl> datatype, and `name-clean` needed to be renamed to `name_clean`. After cleaning the data, we were able to confirm the findings by filtering amounts donated by the two donors named in the article. The results confirmed that the George Strobel and Robin Delmer did donate over $87,000.


```{r}

donors <- donors |>
  rename(
    name_clean = "name-clean"
  )

glimpse(donors)

```

```{r}

# Put code to reverse engineer sentence here
donors |>
  filter(name_clean == "GEORGE LEWIS STROBEL II" | name_clean == "ROBIN E DELMER") |>
  group_by(name_clean) |>
  summarise(amount = sum(amount)) |>
  arrange(desc(amount))

# Display results of code below this codeblock


```


### Sentence 2

* **Sentence text**: Senate President Pro Tem Phil Berger's campaign alone raised nearly $222,000 during session. Twenty-three people gave him the maximum allowed: $5,200.

* **Analysis summary**: We were able to reverse engineer data and confirm the finding, but we had to figure out which specific session they were talking about. The 2018 North Carolina short session ran from May 26 to June 29. We filtered by this date, then filtered by donations made to Philip E Berger's committee that were the maximum allowed amount. We then grouped by name and summarized by the sum of the amounts donated. Our final result was 23 distinct rows, which confirmed that 23 people donated the maximum amount to his committee during the NC session.

```{r}

donors |>
  filter(date >= '2018-05-16' & date <= '2018-06-29') |>
  filter(committee_name == "PHILIP E BERGER COMM") |>
  filter(amount == 5200) |>
  group_by(name_clean) |>
  summarise(sum = sum(amount)) |>
  arrange(desc(sum))

```


### Sentence 3

* **Sentence text**: Beer distributors also gave during session. Mark Craig, the president of distributor R.H. Barringer, put more than $30,000 into state legislative campaigns during the six-week period, including the maximum $5,200 to Berger. 

* **Analysis summary**: We were able to confirm the findings by first filtering by the dates of the session, which were May 26th to June 29th. We then filtered for donations by Mark R Craig that were equal to $5,200 and went to Berger's committee. This showed that Craig did make a single maximum $5,200 donation to Berger's committee.

For the second part of the sentence, we filtered for donations made by Mark R Craig during the dates the session took place during. We then used summarize to get the total sum of his donations. We found that he donated a total of $33,200 during the session, which matched what the article said.

```{r}
#vv code for showing Craig made the a maximum donation amount to Berger.

markcraig <- donors |>
  filter(date >= '2018-05-16' & date <= '2018-06-29') |>
  filter(name_clean == "MARK R CRAIG") |>
  filter(amount == 5200) |>
  group_by(name_clean, date, amount, committee_name) |>
  summarise(sum(amount))

head(markcraig)

```
```{r}
##vv code showing how much CRaig contributed during the NC General Assembly ($33,000+) 

donors |>
  filter(name_clean == "MARK R CRAIG") |>
  group_by(name_clean) |>
  summarise(
    total = sum(amount, na.rm = TRUE) 
  )

```


### Sentence 4

* **Sentence text**: Add in donations to the two main political parties and to a handful of other large fundraising vehicles for state legislative races, and the in-session giving topped $3.4 million. Gov. Roy Cooper's main campaign account brought in another $407,000 during session.

* **Analysis summary**: We can't confirm this sentence because we cannot find a specific committee associated with Governor Roy Cooper, nor one associated with his campaign's main account. We also did not find any total donations during the session that equaled $407,000.

```{r}
# Put code to reverse engineer sentence here

donors |>
  filter(date >= '2018-05-16' & date <= '2018-06-29') |>
  group_by(committee_name) |>
  summarise(total = sum(amount)) |>
  arrange(desc(total))
  
## We can't confirm this sentence because we cannot find a specific committee associated with Governor Roy Cooper, nor one associated with his campaign's main account. We also did not find any total donations during the session that equaled 407,000.

# Display results of code below this codeblock

```

### Sentence 5

* **Sentence text**: “A WRAL News analysis of campaign finance filings also turned up $16,000 in donations to legislative campaigns during session from 15 PACs with a lobbyist. Each would appear to be a violation of state fundraising rules, but spokespeople for most of the PACs, or the companies they represent, said there was a simple explanation: The checks were written before session.”

* **Analysis summary**: We were not able to confirm the sentence for multiple reasons. After checking our organization names against a list of PAC organizations, we were able to narrow down PAC organizations donated during session. However, the total amount donated is much greater than the amount listed in the article, which claimed 15 PAC organizations donated "up to $16,000."

```{r}
# Put code to reverse engineer sentence here

pacdonations <- donors |>
  filter(date >= '2018-05-16' & date <= '2018-06-29') |>
  filter(str_detect(name_clean, "PAC"))

pacdonations

# Display results of code below this codeblock

```

```{r}

pactotal <- pacdonations |>
  filter(date >= '2018-05-16' & date <= '2018-06-29') |>
  filter(name_clean == "NORTH CAROLINA BEER & WINE WHOLESALERS ASSOC PAC" | name_clean == "NC OUTDOOR ADVERTISING ASSOC PAC" | name_clean == "NC CHIROPRACTIC ASSOC PAC" | name_clean == "NC STATE OPTOMETRIC SOCIETY PAC" | name_clean == "NC FIRE PAC" | name_clean == "NC ADCOVATES FOR JUSTICE PAC" | name_clean == "NC PORK COUNCIL PAC" | name_clean == "NC POULTRY FEDERATION PAC" | name_clean == "NC POULTRY FEDERATION PAC" | name_clean == "SMITHFIELD FOODS PAC" | name_clean == "WALMART STORES PAC" | name_clean == "WARD AND SMITH PAC" | name_clean == "REMY KEMP & ASSOCIATES PAC" | name_clean == "BB&T PAC" | name_clean == "AT&T PAC" | name_clean == "NATIONWIDE CAROLINA PAC")

pactotal |>
  group_by(name_clean) |>
  summarise(
    total_amount = sum(amount)
  ) |>
  arrange(desc(total_amount))
```


-30-